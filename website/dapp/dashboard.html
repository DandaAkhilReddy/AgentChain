<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü§ñ AgentChains AI Dashboard - KAMIKAZE Token Management</title>
    <link rel="stylesheet" href="../css/future-ai-theme.css">
    <script src="https://unpkg.com/web3@latest/dist/web3.min.js"></script>
    <script src="../js/blockchain.js"></script>
</head>
<body class="gpu-accelerated">
    <!-- Neural Network Background -->
    <div class="animated-bg"></div>
    <div class="neural-viz" id="neuralViz"></div>
    
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <span class="logo-icon">ü§ñ</span>
                <span class="logo-text">AgentChains</span>
            </div>
            <div style="display: flex; gap: 1rem; align-items: center;">
                <span id="walletStatus" class="glass-effect" style="padding: 0.5rem 1rem; border-radius: 8px; font-size: 0.9rem;">
                    üîó Connect Wallet
                </span>
                <a href="../index.html" class="cta-secondary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                    ‚Üê Back to Home
                </a>
            </div>
        </div>
    </nav>

    <div style="padding-top: 100px; min-height: 100vh;">
        <!-- AI Dashboard Header -->
        <div style="text-align: center; padding: 2rem; margin-bottom: 3rem;">
            <h1 style="font-size: 3rem; font-weight: 800; background: linear-gradient(45deg, #00ff88, #00d4ff, #7c3aed); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 1rem;">
                AI-Powered KAMIKAZE Dashboard
            </h1>
            <p style="color: #b4bcd0; font-size: 1.2rem; max-width: 600px; margin: 0 auto;">
                Manage your deflationary tokens with Principal Scientist-grade AI intelligence
            </p>
        </div>

        <!-- Main Dashboard Grid -->
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; max-width: 1200px; margin: 0 auto; padding: 0 2rem;">
            
            <!-- Wallet Overview Card -->
            <div class="glass-effect" style="padding: 2rem; border-radius: 20px; border: 1px solid rgba(0, 255, 136, 0.3);">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                    <span style="font-size: 2rem;">üíé</span>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">Wallet Overview</h2>
                </div>
                
                <div style="margin-bottom: 2rem;">
                    <div style="color: #b4bcd0; font-size: 0.9rem; margin-bottom: 0.5rem;">KAMIKAZE Balance</div>
                    <div style="font-size: 2.5rem; font-weight: 800; color: #00ff88;" id="tokenBalance">
                        0 KAMIKAZE
                    </div>
                    <div style="color: #b4bcd0; font-size: 0.9rem; margin-top: 0.5rem;">
                        ‚âà $<span id="usdValue">0.00</span> USD
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="glass-effect" style="padding: 1rem; border-radius: 12px; text-align: center;">
                        <div style="color: #00d4ff; font-size: 1.3rem; font-weight: 700;">2%</div>
                        <div style="color: #b4bcd0; font-size: 0.8rem;">Burn Rate</div>
                    </div>
                    <div class="glass-effect" style="padding: 1rem; border-radius: 12px; text-align: center;">
                        <div style="color: #ff6b35; font-size: 1.3rem; font-weight: 700;" id="totalBurned">0</div>
                        <div style="color: #b4bcd0; font-size: 0.8rem;">Tokens Burned</div>
                    </div>
                </div>
            </div>

            <!-- AI Trading Assistant -->
            <div class="glass-effect" style="padding: 2rem; border-radius: 20px; border: 1px solid rgba(124, 58, 237, 0.3);">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                    <span style="font-size: 2rem;">üß†</span>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">AI Trading Assistant</h2>
                </div>
                
                <div style="margin-bottom: 1.5rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                        <span style="color: #b4bcd0;">Market Sentiment</span>
                        <span style="color: #00ff88; font-weight: 600;">Bullish üìà</span>
                    </div>
                    <div class="progress-bar" style="width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden;">
                        <div class="progress-fill" style="width: 76%; height: 100%; background: linear-gradient(90deg, #00ff88, #00d4ff); animation: pulse 2s infinite;"></div>
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 2rem;">
                    <div style="text-align: center;">
                        <div style="color: #7c3aed; font-size: 1.2rem; font-weight: 700;">94.7%</div>
                        <div style="color: #b4bcd0; font-size: 0.8rem;">AI Accuracy</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #ec4899; font-size: 1.2rem; font-weight: 700;">2.3ms</div>
                        <div style="color: #b4bcd0; font-size: 0.8rem;">Response Time</div>
                    </div>
                </div>

                <button class="cta-primary" style="width: 100%; justify-content: center;">
                    üéØ Enable AI Trading
                </button>
            </div>

            <!-- Send Tokens Card -->
            <div class="glass-effect" style="padding: 2rem; border-radius: 20px; border: 1px solid rgba(0, 212, 255, 0.3);">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                    <span style="font-size: 2rem;">üöÄ</span>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">Send KAMIKAZE</h2>
                </div>
                
                <form id="sendTokenForm" style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <div>
                        <label style="color: #b4bcd0; font-size: 0.9rem; display: block; margin-bottom: 0.5rem;">Recipient Address</label>
                        <input type="text" id="recipientAddress" placeholder="0x..." 
                               style="width: 100%; padding: 1rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: white; font-family: 'JetBrains Mono', monospace;">
                    </div>
                    
                    <div>
                        <label style="color: #b4bcd0; font-size: 0.9rem; display: block; margin-bottom: 0.5rem;">Amount</label>
                        <input type="number" id="sendAmount" placeholder="0.00" 
                               style="width: 100%; padding: 1rem; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: white;">
                    </div>
                    
                    <div class="glass-effect" style="padding: 1rem; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between; font-size: 0.9rem;">
                            <span style="color: #b4bcd0;">Amount to send:</span>
                            <span id="sendPreview">0 KAMIKAZE</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.9rem; margin-top: 0.5rem;">
                            <span style="color: #ff6b35;">Burn (2%):</span>
                            <span id="burnPreview">0 KAMIKAZE</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 0.9rem; margin-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 0.5rem;">
                            <span style="color: #00ff88; font-weight: 600;">Recipient receives:</span>
                            <span id="receivePreview">0 KAMIKAZE</span>
                        </div>
                    </div>
                    
                    <button type="submit" class="cta-primary" style="width: 100%; justify-content: center;">
                        ‚ö° Send Tokens
                    </button>
                </form>
            </div>

            <!-- Transaction History -->
            <div class="glass-effect" style="padding: 2rem; border-radius: 20px; border: 1px solid rgba(255, 107, 53, 0.3);">
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 2rem;">
                    <span style="font-size: 2rem;">üìä</span>
                    <h2 style="font-size: 1.5rem; font-weight: 700;">Transaction History</h2>
                </div>
                
                <div id="transactionHistory" style="max-height: 300px; overflow-y: auto;">
                    <div style="text-align: center; color: #b4bcd0; padding: 2rem;">
                        <span style="font-size: 3rem; opacity: 0.3;">üìù</span>
                        <p>No transactions yet</p>
                        <p style="font-size: 0.9rem;">Connect your wallet to view history</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Analytics Section -->
        <div style="margin: 4rem auto; max-width: 1200px; padding: 0 2rem;">
            <h2 style="text-align: center; font-size: 2.5rem; font-weight: 800; margin-bottom: 3rem; background: linear-gradient(45deg, #00ff88, #7c3aed); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                Real-Time Neural Analytics
            </h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                <div class="glass-effect neural-glow" style="padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">‚ö°</div>
                    <div style="font-size: 2rem; font-weight: 800; color: #00ff88;" id="networkSpeed">47.3 TH/s</div>
                    <div style="color: #b4bcd0;">Network Hashrate</div>
                </div>
                
                <div class="glass-effect neural-glow" style="padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">ü§ñ</div>
                    <div style="font-size: 2rem; font-weight: 800; color: #00d4ff;" id="activeAI">156,429</div>
                    <div style="color: #b4bcd0;">AI Operations/Hour</div>
                </div>
                
                <div class="glass-effect neural-glow" style="padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üî•</div>
                    <div style="font-size: 2rem; font-weight: 800; color: #ff6b35;" id="burnRate">2.1%</div>
                    <div style="color: #b4bcd0;">Effective Burn Rate</div>
                </div>
                
                <div class="glass-effect neural-glow" style="padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2rem; margin-bottom: 1rem;">üíé</div>
                    <div style="font-size: 2rem; font-weight: 800; color: #7c3aed;" id="stakingAPY">25.3%</div>
                    <div style="color: #b4bcd0;">Current Staking APY</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Web3 and blockchain
        let web3;
        let userAccount;
        let blockchain;

        // Initialize the dApp
        document.addEventListener('DOMContentLoaded', async () => {
            // Initialize blockchain
            blockchain = new AgentChainsBlockchain();
            
            // Add neural nodes
            createNeuralNodes();
            
            // Animate counters
            animateAnalytics();
            
            // Setup form handlers
            setupFormHandlers();
            
            // Check if MetaMask is available
            if (typeof window.ethereum !== 'undefined') {
                web3 = new Web3(window.ethereum);
                
                // Check if already connected
                const accounts = await web3.eth.getAccounts();
                if (accounts.length > 0) {
                    connectWallet();
                }
            }
            
            // Auto-connect prompt after 2 seconds
            setTimeout(() => {
                if (!userAccount) {
                    document.getElementById('walletStatus').innerHTML = 'üîó <span style="animation: pulse 1s infinite;">Click to Connect Wallet</span>';
                    document.getElementById('walletStatus').onclick = connectWallet;
                }
            }, 2000);
        });

        // Connect MetaMask wallet
        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    alert('Please install MetaMask to use this dApp!');
                    return;
                }

                // Request account access
                const accounts = await window.ethereum.request({
                    method: 'eth_requestAccounts'
                });

                userAccount = accounts[0];
                
                // Create account in blockchain if doesn't exist
                blockchain.createAccount(userAccount);
                
                // Update UI
                updateWalletDisplay();
                updateTransactionHistory();
                
                console.log('Wallet connected:', userAccount);
                
                // Show success message
                showNotification('üéâ Wallet connected successfully!', 'success');
                
            } catch (error) {
                console.error('Failed to connect wallet:', error);
                showNotification('‚ùå Failed to connect wallet', 'error');
            }
        }

        // Update wallet display
        function updateWalletDisplay() {
            if (userAccount) {
                const balance = blockchain.getBalance(userAccount);
                document.getElementById('tokenBalance').textContent = 
                    balance.toLocaleString() + ' KAMIKAZE';
                document.getElementById('usdValue').textContent = 
                    (balance * 0.001).toFixed(2);
                
                // Update wallet status
                document.getElementById('walletStatus').innerHTML = 
                    `üü¢ ${userAccount.substring(0, 6)}...${userAccount.substring(userAccount.length - 4)}`;
                document.getElementById('walletStatus').onclick = null;
            }
        }

        // Setup form handlers
        function setupFormHandlers() {
            const sendForm = document.getElementById('sendTokenForm');
            const amountInput = document.getElementById('sendAmount');
            
            // Real-time preview updates
            amountInput.addEventListener('input', updateSendPreview);
            
            // Form submission
            sendForm.addEventListener('submit', (e) => {
                e.preventDefault();
                sendTokens();
            });
        }

        // Update send preview
        function updateSendPreview() {
            const amount = parseFloat(document.getElementById('sendAmount').value) || 0;
            const burnAmount = amount * 0.02;
            const receiveAmount = amount - burnAmount;
            
            document.getElementById('sendPreview').textContent = amount.toFixed(4) + ' KAMIKAZE';
            document.getElementById('burnPreview').textContent = burnAmount.toFixed(4) + ' KAMIKAZE';
            document.getElementById('receivePreview').textContent = receiveAmount.toFixed(4) + ' KAMIKAZE';
        }

        // Send tokens
        function sendTokens() {
            if (!userAccount) {
                showNotification('‚ö†Ô∏è Please connect your wallet first', 'warning');
                return;
            }
            
            const recipient = document.getElementById('recipientAddress').value;
            const amount = parseFloat(document.getElementById('sendAmount').value);
            
            if (!recipient || !amount || amount <= 0) {
                showNotification('‚ö†Ô∏è Please enter valid recipient and amount', 'warning');
                return;
            }
            
            try {
                // Create and process transaction
                blockchain.createTransaction(userAccount, recipient, amount);
                blockchain.minePendingTransactions(userAccount);
                
                // Update UI
                updateWalletDisplay();
                updateTransactionHistory();
                
                // Clear form
                document.getElementById('sendTokenForm').reset();
                updateSendPreview();
                
                showNotification('üöÄ Transaction sent successfully!', 'success');
                
            } catch (error) {
                console.error('Transaction failed:', error);
                showNotification('‚ùå Transaction failed: ' + error.message, 'error');
            }
        }

        // Update transaction history
        function updateTransactionHistory() {
            if (!userAccount) return;
            
            const transactions = blockchain.getTransactionsForAddress(userAccount);
            const historyDiv = document.getElementById('transactionHistory');
            
            if (transactions.length === 0) {
                historyDiv.innerHTML = `
                    <div style="text-align: center; color: #b4bcd0; padding: 2rem;">
                        <span style="font-size: 3rem; opacity: 0.3;">üìù</span>
                        <p>No transactions yet</p>
                    </div>
                `;
                return;
            }
            
            historyDiv.innerHTML = transactions.slice(0, 10).map(tx => {
                const isOutgoing = tx.fromAddress === userAccount;
                const direction = isOutgoing ? 'Sent' : 'Received';
                const address = isOutgoing ? tx.toAddress : tx.fromAddress;
                const color = isOutgoing ? '#ff6b35' : '#00ff88';
                
                return `
                    <div class="glass-effect" style="padding: 1rem; margin-bottom: 0.5rem; border-radius: 8px; border-left: 3px solid ${color};">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="color: ${color}; font-weight: 600; font-size: 0.9rem;">${direction}</div>
                                <div style="color: #b4bcd0; font-size: 0.8rem;">${address.substring(0, 10)}...${address.substring(address.length - 8)}</div>
                            </div>
                            <div style="text-align: right;">
                                <div style="color: white; font-weight: 600;">${tx.amount.toLocaleString()} KAMIKAZE</div>
                                <div style="color: #b4bcd0; font-size: 0.8rem;">${new Date(tx.timestamp).toLocaleString()}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Show notification
        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                backdrop-filter: blur(20px);
                border: 1px solid rgba(255,255,255,0.2);
            `;
            
            switch(type) {
                case 'success':
                    notification.style.background = 'rgba(0, 255, 136, 0.2)';
                    break;
                case 'error':
                    notification.style.background = 'rgba(255, 107, 53, 0.2)';
                    break;
                case 'warning':
                    notification.style.background = 'rgba(255, 193, 7, 0.2)';
                    break;
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Animate analytics
        function animateAnalytics() {
            const analytics = {
                networkSpeed: { start: 40, end: 47.3, suffix: ' TH/s' },
                activeAI: { start: 150000, end: 156429, suffix: '' },
                burnRate: { start: 2.0, end: 2.1, suffix: '%' },
                stakingAPY: { start: 24.5, end: 25.3, suffix: '%' }
            };
            
            Object.keys(analytics).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    const data = analytics[id];
                    let current = data.start;
                    const increment = (data.end - data.start) / 100;
                    
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= data.end) {
                            current = data.end;
                            clearInterval(timer);
                        }
                        element.textContent = current.toFixed(1) + data.suffix;
                    }, 30);
                }
            });
        }

        // Create neural nodes
        function createNeuralNodes() {
            const viz = document.getElementById('neuralViz');
            if (!viz) return;
            
            for (let i = 0; i < 30; i++) {
                const node = document.createElement('div');
                node.className = 'neural-node';
                node.style.left = Math.random() * 100 + '%';
                node.style.top = Math.random() * 100 + '%';
                node.style.animationDelay = Math.random() * 4 + 's';
                viz.appendChild(node);
            }
        }
    </script>

    <style>
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        input:focus {
            outline: none;
            border-color: #00ff88 !important;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }
        
        .glass-effect:hover {
            border-color: rgba(0, 255, 136, 0.5);
            box-shadow: 0 10px 40px rgba(0, 255, 136, 0.2);
        }
        
        .neural-glow:hover {
            animation: neuralPulse 2s ease-in-out infinite;
        }
    </style>
</body>
</html>